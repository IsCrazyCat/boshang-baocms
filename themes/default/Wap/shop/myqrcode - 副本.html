<include file="public:header"/>
	<header class="top-fixed bg-yellow bg-inverse">
		<div class="top-back">
			<a class="top-addr" href="<{:U('shop/detail',array('shop_id'=>$shop['shop_id']))}>"><i class="icon-angle-left"></i></a>
		</div>
		<div class="top-title">
			<{$shop.shop_name}>
		</div>
		<!--<div class="top-share">
			<a href="javascript:void(0);" id="share-btn"><i class="icon-share"></i></a>
		</div>-->
	</header>
	  
	<!--<div id="share-box" class="share-box">
		<div class="dialog-mask"></div>
			<ul class="line">
				<li class="-mob-share-weibo x3">
					<img src="/static/default/wap/image/share/share-weibo.png" />
					<p>新浪微博</p>
				</li>
				<li class="-mob-share-tencentweibo x3">
					<img src="/static/default/wap/image/share/share-twb.png" />
					<p>腾讯微博</p>
				</li>
				<li class="-mob-share-qzone x3">
					<img src="/static/default/wap/image/share/share-qzone.png" />
					<p>QQ空间</p>
				</li>
				
				<li class="-mob-share-qq x3">
					<img src="/static/default/wap/image/share/share-py.png" />
					<p>QQ好友</p>
				</li>
				<li class="-mob-share-weixin x3">
					<img src="/static/default/wap/image/share/share-weixin.png" />
					<p>微信</p>
				</li>
				<li class="-mob-share-renren x3">
					<img src="/static/default/wap/image/share/share-renren.png" />
					<p>人人网</p>
				</li>
				<li class="-mob-share-kaixin x3">
					<img src="/static/default/wap/image/share/share-kaixin.png" />
					<p>开心网</p>
				</li>
				<li id="mui-card-close" class="mui-card-close x3">
					<img src="/static/default/wap/image/share/share-close.png" />
					<p>关闭</p>
				</li>
			</ul>
		<script id="-mob-share" src="http://f1.webshare.mob.com/code/mob-share.js?appkey=890ab8bbdb3c"></script>
	</div>-->
	<script>
		$(document).ready(function () {
			$("#share-box").hide();
			$("#share-btn").click(function () {
				$("#share-box").toggle();
				$('html,body').animate({scrollTop:0}, 'slow');
			});
			$("#mui-card-close").click(function () {
				$("#share-box").hide();
			});
		});
	</script>
	
                
               
	<div class="container">

		<div class="padding-large">
            <div id="qr_container" style="margin:auto; position:relative; width:100%; text-align:center; display:none" ></div>
            <div id="imgDiv" style="margin:auto; position:relative; width:100%; text-align:center;"></div>
			
		</div>
		<p class="text-center">微信里长按识别二维码</p>

	</div>
 
 
 <!--<script src="js/jquery-2.1.4.min.js"></script>-->
<script src="/my/js/jquery.qrcode.min.js"></script>
 
 
    
    

<div id="imgDiv"></div>

<script>
	$(document).ready(function(){
    // 点击生成二维码
   
        /*如果已生成过二维码，则删除二维码img图片和canvas，重新生成；反之，则直接生成二维码*/
        
    createQr();
        
  
    // 生成二维码
    function createQr(){
        document.createElement('canvas').getContext('2d');
        var valText = "http://www.blklube.com/User/money/myindex/shop_id/<{$shop.shop_id}>";
 
        // 采用正则表达式判断输入的内容是否是中文
        var reg=/^[\u0391-\uFFE5]+$/; 
         if(valText!=""&&!reg.test(valText)){ 
            // 如果不是中文，直接将输入的内容转换成二维码
            $('#qr_container').qrcode({render:"canvas",height:280, width:280,correctLevel:0,text:valText});
         }else{
            // 如果是中文，直接将输入的内容字符串转换成UTF-8，然后再转换成二维码
            $('#qr_container').qrcode({render:"canvas",height:280, width:280,correctLevel:0,text:utf16to8(valText)});
         }
 
        //获取网页中的canvas对象
        var mycanvas1=document.getElementsByTagName('canvas')[0];
 
        //将转换后的img标签插入到html中
        var img = convertCanvasToImage(mycanvas1);
       $('#imgDiv').append(img);//imgDiv表示你要插入的容器id
    }
 
    // 字符编码
    function utf16to8(str) {  
        var out, i, len, c;  
        out = "";  
        len = str.length;  
        for(i = 0; i < len; i++) {  
        c = str.charCodeAt(i);  
        if ((c >= 0x0001) && (c <= 0x007F)) {  
            out += str.charAt(i);  
        } else if (c > 0x07FF) {  
            out += String.fromCharCode(0xE0 | ((c >> 12) & 0x0F));  
            out += String.fromCharCode(0x80 | ((c >>  6) & 0x3F));  
            out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));  
        } else {  
            out += String.fromCharCode(0xC0 | ((c >>  6) & 0x1F));  
            out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));  
        }  
        }  
        return out;  
    }
 
    //从canvas中提取图片image
    function convertCanvasToImage(canvas) {
        //新Image对象，可以理解为DOM
        var image = new Image();
        // canvas.toDataURL 返回的是一串Base64编码的URL
        // 指定格式PNG
        image.src = canvas.toDataURL("image/png");
        return image;
    }
});
	
</script>
<style type="text/css">
.sc_ico {
	background-image:url(/themes/default/Mobile/index/img/fenlei.png) no-repeat 0px 0px;
}
.sc_ico {
	background-image:url(/themes/default/Mobile/index/img/gwc.png) no-repeat 0px 0px;
}
</style>

<include file="public/footer-shop" />
